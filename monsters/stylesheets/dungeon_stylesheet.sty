% ------------------------------------------------------------------------------------------------- %
%                	        dungeon_commands.sty  Marcel Zauder 09/08/2023       	                %
% Stylesheet by Marcel                                                                              %
% ------------------------------------------------------------------------------------------------- %
\usepackage{fontspec}

\usepackage[singlelinecheck=false]{caption}
\usepackage{lipsum}
\usepackage{listings}
\usepackage{shortvrb}
\usepackage{stfloats}
\usepackage{changepage}

\usepackage{transparent}

%\usepackage{pstricks}
%\usepackage[pscoord]{eso-pic}% The zero point of the coordinate system is the lower left corner of the page (the default).
\usepackage{calc}
\usepackage[absolute]{textpos}
\usepackage{graphbox}

\usepackage{tikzpagenodes}
\usetikzlibrary{positioning}
\usetikzlibrary{fadings} 
\usetikzlibrary{calc}
\usetikzlibrary{backgrounds, calc, shadows, shadows.blur}
\usepackage{varwidth}

\usepackage{datatool}

\captionsetup[table]{labelformat=empty,font={sf,sc,bf,},skip=0pt}

\MakeShortVerb{|}

\lstset{%
  basicstyle=\ttfamily,
  language=[LaTeX]{TeX},
  breaklines=true,
}
% -------------------------------------------------------------------------------------------------- %
% ################################################################################################## %
% --------------------------------------- Dungeon Main Page ---------------------------------------- %
\def\splitShadowfyColors#1/#2\relax{%
	\def\primarycolor{#1}
	\def\secondarycolor{#2}
}%
% -------------------------------------------------------------------------------------------------- %
% ################################################################################################## %
% --------------------------------------- Dungeon Main Page ---------------------------------------- %
\newcommand{\dungeonTitlePage}[8]{%
	\begin{tikzpicture}[remember picture,overlay]
		\expandafter\def\expandafter\temp\expandafter{#1}%
		\edef\temp{#1}
		\expandafter\splitShadowfyColors\temp\relax%
		
		\node[opacity=1,inner sep=0pt,xshift=#2,yshift=#3] at (current page.center){\includegraphics[#4, keepaspectratio]{#5}};
		\addImageDBEntry#6
		\node[yshift=0.405\paperheight] at (current page.center) {\shadowfyClassName{#7}};
				
		\coordinate (redline_left) at ($(current page.center) + (-0.3\paperwidth, 0.375\paperheight)$);
		\draw [rulered, fill = red] (redline_left) -- ++( 0.3\paperwidth, 0.075 ) -- ++( 0.3\paperwidth, -0.075 ) -- ++( -0.3\paperwidth, -0.075 );
		
		\expandafter\def\expandafter\temp\expandafter{#8}%
		\edef\temp{#8}
		\expandafter\splitShadowfyColors\temp\relax%
		\def\stackgap{0.01pt}
		\node[yshift=-0.4\paperheight] at (current page.center) {\titlefont{ \shadowfy{The homebrew Dungeon "#7"}}};
	\end{tikzpicture}
}%
% -------------------------------------------------------------------------------------------------- %
% ################################################################################################## %
% -------------------------------------- Dungeon Trap Fields --------------------------------------- %
\newcommand{\trapFields}[1]{%
	\node[rectangle, thick, draw=red, dotted, minimum width=0.3cm, minimum height=0.3cm, inner sep=0, outer sep=0pt, anchor=south west] at (#1) {\textcolor{red}{T}};%
}%