% ------------------------------------------------------------------------------------------------- %
%                        	   shadowfy.sty  Marcel Zauder 23/03/2021           	                %
% Stylesheet by Marcel                                                                              %
% ------------------------------------------------------------------------------------------------- %
% ################################################################################################# %
% ------------------------------------------ Usepackages ------------------------------------------ %
\usepackage{stackengine}
\usepackage{xcolor}
% ------------------------------------------------------------------------------------------------- %
% ################################################################################################# %
% --------------------------------- Variables that can be changed --------------------------------- %
\def\primarycolor{white}
\def\secondarycolor{black}
% ------------------------------------------------------------------------------------------------- %
% ################################################################################################# %
% -------------------------------------- Base Shadowfy Makro -------------------------------------- %
\newcommand\shadowfy[1]{\expandafter\shadowfypars#1\par\relax\relax}
\long\def\shadowfypars#1\par#2\relax{%
  \ifx#1\relax\else%
    \shadowfywords#1 \relax\relax%
  \fi%
  \ifx\relax#2\else\par\shadowfypars#2\relax\fi%
}
\def\shadowfywords#1 #2\relax{%
  \ifx#1\relax\else%
    \shadowfyletters#1\relax\relax%
  \fi%
  \ifx\relax#2\else\ \shadowfywords#2\relax\fi%
}
\def\shadowfyletters#1#2\relax{%
  \shadow{#1}%
  \ifx\relax#2\else\shadowfyletters#2\relax\fi}%

\newlength\shadowHoffset%
\newlength\shadowVoffset%
\setlength\shadowHoffset{1.5pt}%
\setlength\shadowVoffset{1.5pt}%

\def\stackgap{0.1pt}%

\def\shadow#1{\setstackgap{L}{\stackgap}\def\stacktype{L}%
%\def\useanchorwidth{T}% CAN BE COMMENTED FOR MORE INTERLETTER SPACE.
\Longstack{%
\raisebox{0pt}{\textcolor{\primarycolor}{#1}} 
\kern.7\shadowHoffset\raisebox{.7\shadowVoffset}{\textcolor{\secondarycolor}{#1}}
\kern-.7\shadowHoffset\raisebox{.7\shadowVoffset}{\textcolor{\secondarycolor}{#1}}
\kern\shadowHoffset\raisebox{0pt}{\textcolor{\secondarycolor}{#1}}
\kern-\shadowHoffset\raisebox{0pt}{\textcolor{\secondarycolor}{#1}}
\kern.7\shadowHoffset\raisebox{-.7\shadowVoffset}{\textcolor{\secondarycolor}{#1}}
\kern-.7\shadowHoffset\raisebox{-.7\shadowVoffset}{\textcolor{\secondarycolor}{#1}}
\kern0pt\raisebox{\shadowVoffset}{\textcolor{\secondarycolor}{#1}}
\kern0pt\raisebox{-\shadowVoffset}{\textcolor{\secondarycolor}{#1}}%
}}
% ------------------------------------------------------------------------------------------------- %
% ################################################################################################# %
% ---------------------------------- Automatic TextSC Shadowfier ---------------------------------- %
% Define the custom macro that takes a word as a parameter
\newcommand{\customtitle}[1]{%
    \StrLen{#1}[\wordlen]%
    \foreach \i in {1,...,\wordlen}{%
        \StrChar{#1}{\i}[\currentletter]%
        \mytitleformat{\currentletter}%
    }%
}%
\newcommand{\mytitleformat}[1]{%
	\isUpperCase{#1}\ifnum\bool=1 \xdef\ucletter{#1}\else\toUpperCaseLetter{#1}\fi%
    	\titlefont{\fontsize{\ifnum\bool=1 40\else30\fi}{50}\selectfont\shadowfy{\ucletter}}%
}%
% ------------------------------------------------------------------------------------------------- %
% ################################################################################################# %
% ------------------------------- Macros for UpperCase Manipulation ------------------------------- %
\newcommand{\toUpperCaseLetter}[1]{%
	\xdef\ucletter{%
		\ifnum\pdfstrcmp{a}{#1}=0 A\fi%
		\ifnum\pdfstrcmp{b}{#1}=0 B\fi%
		\ifnum\pdfstrcmp{c}{#1}=0 C\fi%
		\ifnum\pdfstrcmp{d}{#1}=0 D\fi%
		\ifnum\pdfstrcmp{e}{#1}=0 E\fi%
		\ifnum\pdfstrcmp{f}{#1}=0 F\fi%
		\ifnum\pdfstrcmp{g}{#1}=0 G\fi%
		\ifnum\pdfstrcmp{h}{#1}=0 H\fi%
		\ifnum\pdfstrcmp{i}{#1}=0 I\fi%
		\ifnum\pdfstrcmp{j}{#1}=0 J\fi%
		\ifnum\pdfstrcmp{k}{#1}=0 K\fi%
		\ifnum\pdfstrcmp{l}{#1}=0 L\fi%
		\ifnum\pdfstrcmp{m}{#1}=0 M\fi%
		\ifnum\pdfstrcmp{n}{#1}=0 N\fi%
		\ifnum\pdfstrcmp{o}{#1}=0 O\fi%
		\ifnum\pdfstrcmp{p}{#1}=0 P\fi%
		\ifnum\pdfstrcmp{q}{#1}=0 Q\fi%
		\ifnum\pdfstrcmp{r}{#1}=0 R\fi%
		\ifnum\pdfstrcmp{s}{#1}=0 S\fi%
		\ifnum\pdfstrcmp{t}{#1}=0 T\fi%
		\ifnum\pdfstrcmp{u}{#1}=0 U\fi%
		\ifnum\pdfstrcmp{v}{#1}=0 V\fi%
		\ifnum\pdfstrcmp{w}{#1}=0 W\fi%
		\ifnum\pdfstrcmp{x}{#1}=0 X\fi%
		\ifnum\pdfstrcmp{y}{#1}=0 Y\fi%
		\ifnum\pdfstrcmp{z}{#1}=0 Z\fi%
	}%
	\ifthenelse{\equal{\ucletter}{}}{\xdef\ucletter{#1}}{}%
}%
\newcommand{\isUpperCase}[1]{%
	\ifthenelse{\equal{A}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{B}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{C}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{D}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{E}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{F}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{G}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{H}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{I}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{J}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{K}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{L}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{M}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{N}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{O}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{P}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{Q}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{R}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{S}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{T}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{U}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{V}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{W}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{X}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{Y}{#1}}{\xdef\bool{1}}{%
	\ifthenelse{\equal{Z}{#1}}{\xdef\bool{1}}{\xdef\bool{0}}%
	}}}}}}}}}}}}}}}}}}}}}}}}}%
}%
% -------------------------------------------------------------------------------------------------- %
% ################################################################################################## %
% #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#  New Commands  #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# %
%                                                                                                    %
% #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#  Auto-Shadowfy Class Name  #-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-# %
\newcommand{\shadowfyClassName}[1]{%
	\def\currentWord{}%
	\StrBefore{#1}{ }[\currentWord]%
	\ifx\currentWord\empty%
	% Reached the last word (no more spaces)
		\customtitle{#1}%
	\else%
    	% Process the current word (replace this with your desired action)
		\customtitle{\currentWord}%
	% Remove the processed word from the string
		\StrBehind{#1}{\currentWord}[\remainingString]%
	% Call the command recursively to process the next word
		\shadowfyClassName{\remainingString}%
	\fi%
}